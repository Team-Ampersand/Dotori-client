name: Dotori Client CI

on:
  push:
    branches: [ "feature/cicd" ]
  pull_request:
    branches: [ "feature/cicd" ]

jobs:

  build:
    runs-on: ubuntu-latest

    steps:
    - name: Create .env
      run: 
        echo "$ENV" >> .env
      env:
          ENV: $({secrets.ENV})

    - name: Checkout source code.   # Repo checkout
      uses: actions/checkout@v2
      
    - name: Check Node v            # Node v 확인
      run: node -v

    - name: Install Dependencies    # 의존 파일 설치
      run: yarn install --frozen-lockfile

    - name: Build                   # React Build
      run: yarn build

    - name: Dotori Client CI Success Discord Notification
      uses: sarisia/actions-status-discord@v1
      if: ${{ success() }}
      with:
        title: 🎉 Dotori Client CI 🐿
        webhook: ${{ secrets.DISCORD_WEBHOOK }}
        color: 00FF00
    - name: Dotori Client CI Fail Discord Notification
      uses: sarisia/actions-status-discord@v1
      if: ${{ failure() }}
      with:
        title: ❌ Dotori Client CI 🐿
        webhook: ${{ secrets.DISCORD_WEBHOOK }}
        color: FF0000