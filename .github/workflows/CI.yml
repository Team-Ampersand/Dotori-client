name: Dotori Client CI

on:
  push:
    branches: [ "feature/cicd" ]
  pull_request:
    branches: [ "feature/cicd" ]

jobs:

  build:
    runs-on: ubuntu-latest

    steps:
    - name: Create .env             # .env íŒŒì¼ ì„¤ì •
      run: 
        echo "${{secrets.ENV}}" >> .env

    - name: Checkout source code.   # Repo checkout
      uses: actions/checkout@v2
      
    - name: Check Node v            # Node v í™•ì¸
      run: node -v

    - name: Install Dependencies    # ì˜ì¡´ íŒŒì¼ ì„¤ì¹˜
      run: |
        yarn install
        yarn install --frozen-lockfile

    - name: Build                   # React Build
      run: 
        CI=false yarn run build

    - name: Dotori Client CI Success Discord Notification
      uses: sarisia/actions-status-discord@v1
      if: ${{ success() }}
      with:
        title: ğŸ‰ Dotori Client CI ğŸ¿
        webhook: ${{ secrets.DISCORD_WEBHOOK }}
        color: 00FF00
    - name: Dotori Client CI Fail Discord Notification
      uses: sarisia/actions-status-discord@v1
      if: ${{ failure() }}
      with:
        title: âŒ Dotori Client CI ğŸ¿
        webhook: ${{ secrets.DISCORD_WEBHOOK }}
        color: FF0000